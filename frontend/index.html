<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forecasting API</title>
</head>
<body>
    <h1>Consumption Forecast</h1>

    <label for="year">Enter Year:</label>
    <select id="year">
        <option value="2023">2023</option>
        <option value="2024">2024</option>
        <option value="2025">2025</option>
    </select>

    <label for="model">Select Model:</label>
    <select id="model">
        <option value="AR">AR</option>
        <option value="ARMA">ARMA</option>
        <option value="MA">MA</option>
        <option value="SARIMAX">SARIMAX</option>
    </select>

    <button onclick="getForecast()">Predict</button>
    <pre id="result"></pre>

    <script>
        async function getForecast() {
            let year = document.getElementById("year").value;
            let model = document.getElementById("model").value;

            if (!year) {
                alert("Please enter a year.");
                return;
            }
            else if (!model) {
                alert("Please select a model.");
                return;
            }
            
            try {
                let url = `http://127.0.0.1:8000/predict/${model}/${year}`;
                console.log("Fetching URL:", url);

                let response = await fetch(url);
                // alert("No problem here");

                console.log("Response Status:", response.status);
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                let data = await response.json();
                // alert("Still no problem here");

                console.log("Received Data:", data);
                document.getElementById("result").textContent = `Pr√©dictions pour ${parseInt(year) + 1} (model ${model}):\n` + JSON.stringify(data, null, 2);

            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById("result").textContent = "Error fetching forecast.";
            }
        }
    </script>

</body>
</html>
